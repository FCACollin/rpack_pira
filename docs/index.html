<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis as an R package: RRMS and PIRA • RPack.PIRA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Analysis as an R package: RRMS and PIRA">
<meta property="og:description" content="Analysis of real-world data to study the
    Progression Independent of Relapse Activity within the Polish
    population of Relapsing-Remitting Multiple Sclerosis subjects.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">RPack.PIRA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="rpack-pira" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#rpack-pira" class="anchor"></a>RPack.PIRA</h1></div>
<!-- badges: start -->

<p>This is the analysis behind the <em>Assessment of Disability Progression Independent of Relapse and Brain MRI Activity in Patients with Multiple Sclerosis in Poland</em> (Kapica-Topczewska et al. 2021), a peer-reviewed paper available at: <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>. The code has not been further optimised but reproduces with fidelity the reported results.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of <code>RPack.PIRA</code> from <a href="https://github.com/FCACollin/rpack_pira">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"FCACollin/rpack_pira"</span><span class="op">)</span></code></pre></div>
</div>
<div id="analysis-run" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-run" class="anchor"></a>Analysis Run</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://FCACollin.github.io/Latarnia">RPack.PIRA</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/emmeans">emmeans</a></span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">ggthemr</span><span class="op">)</span><span class="op">)</span> <span class="fu">ggthemr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemr/man/ggthemr.html">ggthemr</a></span><span class="op">(</span><span class="st">"fresh"</span><span class="op">)</span> 

<span class="va">captions</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    fig1 <span class="op">=</span> <span class="st">"**Figure 1.** Comparison between observed frequencies of worsening
    diseases and month of observation when no relapse was ever recorded.
    The upper pane uses the complete set of observations
    (green; label at y = 1 is \"All\"),
      the middle pane uses first- and second-line treatment
      (label at y = 1; first-line, dark brown; second-line, dark blue),
      and the lower pane uses drug
      (label at y = 1; Fingolimod, red, FTY; Glatiramer Acetate, dark blue,
        GLA; Interferon, blue, INF; Natalizumab, light brown, NAT).
      Abundance is represented by transparency and the figure at the top of
      each bar. The error bar represents the standard error estimated as
      p × (1 − p)/n, with p being the number of positives and n the total
      number of observations.  DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>,
      fig2 <span class="op">=</span> <span class="st">"**Figure 2**. Comparison of disease worsening and one relapse
      during the first year of treatment (between 6 and 12 months).
      Colors are for: R0 = no relapse, R1 = relapse during the first year.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>,
      fig3 <span class="op">=</span> <span class="st">"**Figure 3**.
      Comparison between disease worsening and three scenarios:
      R0 (no relapse), R1 (relapse during the first year),
      and R2 (relapse during the second year).
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>,
      fig4 <span class="op">=</span> <span class="st">"**Figure 4**.
      Comparison between MRI activity and the three scenarios:
      R0 (no relapse), R1 (relapse during the first year), and
      R2 (relapse during the second year).
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>,
      fig5 <span class="op">=</span> <span class="st">"**Figure 5.** Comparison between the observed frequencies of MRI
      activity and month of observation when no relapse was
      ever recorded. The upper pane uses the complete set of observations
      (green; label at y = 1 is “All”), the middle pane uses
      first- and second-line treatment (label at y = 1; first-line, dark brown;
        second-line, dark blue), and the lower pane uses the
      drug (label at y = 1; Fingolimod, red, FTY;
        Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF; Natalizumab,
        light brown, NAT). DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>,
      fig6 <span class="op">=</span> <span class="st">"**Figure 6**. Patients with evidenced disease progression:
      the proportion of estimations derived from observation of patients
      never associated with any relapses or brain MRI activity between 12
      and 60 months from the prescription start. The upper
      pane uses the complete set of observations
      (green; label at y = 1 is “All”), the middle pane uses first- and
      second-line treatment (label at y = 1; first-line, dark brown;
        second-line, dark blue), and the lower pane uses the drug
      (label at y = 1; Fingolimod, red, FTY;
        Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF;
        Natalizumab, light brown, NAT). The
      error bar represents the standard error estimated asp × (1 − p)/n,
      with p being the number of positives and n the total
      number of observations. DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021."</span>
      <span class="op">)</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span> </code></pre></div>
<div id="patient-characteristics" class="section level3">
<h3 class="hasAnchor">
<a href="#patient-characteristics" class="anchor"></a>Patient characteristics</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">ADPIRA</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ADPIRA</span><span class="op">$</span><span class="va">presc_months_cat</span>, <span class="va">ADPIRA</span><span class="op">$</span><span class="va">ARM</span><span class="op">)</span><span class="op">)</span>

<span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
  <span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="va">X</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>

      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
        Arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">ARMCD</span><span class="op">)</span>,
        Month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">presc_months</span><span class="op">)</span>,
        n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
        F.M <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
        age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span>,
        AgeSympt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">AgeSympt</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
        Sympt2Presc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">Sympt2Presc</span><span class="op">)</span><span class="op">/</span><span class="fl">365.25</span>, <span class="fl">2</span><span class="op">)</span>,
        rlp_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n_rlps_12m</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,
        EDSS_start  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">EDSS_start</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
        EDSS_current <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">EDSS_current</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,
        Worse_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">worse</span><span class="op">)</span>
      <span class="op">)</span>

    <span class="op">}</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>
  <span class="va">tbl</span>,
  caption <span class="op">=</span> <span class="st">"Patient characteristics.
  Abbreviations: Arm = arm of the study;
  R0 = no relapse during treatment; R1, R2 = the occurrence of relapse
  during the first and the second year of treatment, respectively;
  MRI = magnetic resonance imaging; M = months; n = number;
  F:M = female to male ratio;
  Age Symptoms = age at the first symptoms;
  Symptoms = duration from the first symptoms to prescription start in years;
  EDSS = The Expanded Disability Status Scale;
  Worsening number = number of patients with disease worsening."</span>,
  row.names <span class="op">=</span> <span class="cn">FALSE</span>,
  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    Arm <span class="op">=</span> <span class="st">"Arm"</span>, Month <span class="op">=</span> <span class="st">"M"</span>, n <span class="op">=</span> <span class="st">"n"</span>, <span class="st">"F.M"</span> <span class="op">=</span> <span class="st">"F:M"</span>, age <span class="op">=</span> <span class="st">"Age"</span>,
    AgeSympt <span class="op">=</span> <span class="st">"Age Symptoms"</span>, Sympt2Presc <span class="op">=</span> <span class="st">"Symptoms"</span>,
    rlp_n   <span class="op">=</span> <span class="st">"Relapse Number"</span>, EDSS_start <span class="op">=</span> <span class="st">"EDSS Baseline"</span>,
    Worse_n <span class="op">=</span> <span class="st">"Worsening Number"</span>
    <span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">]</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="2%">
<col width="4%">
<col width="4%">
<col width="3%">
<col width="13%">
<col width="9%">
<col width="16%">
<col width="15%">
<col width="3%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">Arm</th>
<th align="right">M</th>
<th align="right">n</th>
<th align="right">F:M</th>
<th align="right">Age</th>
<th align="right">Age Symptoms</th>
<th align="right">Symptoms</th>
<th align="right">Relapse Number</th>
<th align="right">EDSS Baseline</th>
<th align="right">NA</th>
<th align="right">Worsening Number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">R0</td>
<td align="right">12</td>
<td align="right">5339</td>
<td align="right">2.32</td>
<td align="right">36</td>
<td align="right">30.0</td>
<td align="right">3.61</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">231</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="right">24</td>
<td align="right">2961</td>
<td align="right">2.24</td>
<td align="right">37</td>
<td align="right">30.0</td>
<td align="right">3.78</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">184</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="right">36</td>
<td align="right">1392</td>
<td align="right">2.20</td>
<td align="right">36</td>
<td align="right">30.0</td>
<td align="right">3.38</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">93</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="right">48</td>
<td align="right">525</td>
<td align="right">2.28</td>
<td align="right">36</td>
<td align="right">31.0</td>
<td align="right">3.48</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="right">60</td>
<td align="right">255</td>
<td align="right">2.04</td>
<td align="right">36</td>
<td align="right">31.0</td>
<td align="right">3.16</td>
<td align="right">0</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="right">12</td>
<td align="right">4051</td>
<td align="right">2.38</td>
<td align="right">37</td>
<td align="right">31.0</td>
<td align="right">3.90</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">1.5</td>
<td align="right">170</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="right">24</td>
<td align="right">2010</td>
<td align="right">2.33</td>
<td align="right">38</td>
<td align="right">31.0</td>
<td align="right">4.22</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="right">36</td>
<td align="right">885</td>
<td align="right">2.16</td>
<td align="right">38</td>
<td align="right">31.0</td>
<td align="right">3.78</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="right">48</td>
<td align="right">296</td>
<td align="right">2.75</td>
<td align="right">38</td>
<td align="right">32.0</td>
<td align="right">3.78</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="right">60</td>
<td align="right">139</td>
<td align="right">2.56</td>
<td align="right">38</td>
<td align="right">32.0</td>
<td align="right">3.65</td>
<td align="right">0</td>
<td align="right">1.0</td>
<td align="right">1.0</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="right">12</td>
<td align="right">250</td>
<td align="right">2.52</td>
<td align="right">35</td>
<td align="right">28.0</td>
<td align="right">4.21</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.2</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="right">24</td>
<td align="right">80</td>
<td align="right">3.00</td>
<td align="right">36</td>
<td align="right">28.0</td>
<td align="right">4.77</td>
<td align="right">0</td>
<td align="right">2.2</td>
<td align="right">2.0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="right">36</td>
<td align="right">40</td>
<td align="right">2.33</td>
<td align="right">37</td>
<td align="right">29.5</td>
<td align="right">3.32</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="right">48</td>
<td align="right">12</td>
<td align="right">2.00</td>
<td align="right">30</td>
<td align="right">27.0</td>
<td align="right">2.45</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">1.8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="right">60</td>
<td align="right">6</td>
<td align="right">2.00</td>
<td align="right">33</td>
<td align="right">29.0</td>
<td align="right">1.81</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="right">12</td>
<td align="right">592</td>
<td align="right">2.23</td>
<td align="right">35</td>
<td align="right">28.0</td>
<td align="right">4.06</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.5</td>
<td align="right">103</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="right">24</td>
<td align="right">153</td>
<td align="right">2.48</td>
<td align="right">35</td>
<td align="right">28.0</td>
<td align="right">4.37</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="right">36</td>
<td align="right">63</td>
<td align="right">1.86</td>
<td align="right">37</td>
<td align="right">29.0</td>
<td align="right">3.69</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="right">48</td>
<td align="right">21</td>
<td align="right">2.00</td>
<td align="right">32</td>
<td align="right">28.0</td>
<td align="right">2.57</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="right">60</td>
<td align="right">10</td>
<td align="right">1.50</td>
<td align="right">30</td>
<td align="right">27.0</td>
<td align="right">2.03</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.8</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="right">12</td>
<td align="right">342</td>
<td align="right">2.05</td>
<td align="right">35</td>
<td align="right">28.0</td>
<td align="right">4.00</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.5</td>
<td align="right">90</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="right">24</td>
<td align="right">73</td>
<td align="right">2.04</td>
<td align="right">34</td>
<td align="right">28.0</td>
<td align="right">3.98</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="right">36</td>
<td align="right">23</td>
<td align="right">1.30</td>
<td align="right">36</td>
<td align="right">27.0</td>
<td align="right">4.31</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.5</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="right">48</td>
<td align="right">9</td>
<td align="right">2.00</td>
<td align="right">35</td>
<td align="right">30.0</td>
<td align="right">2.79</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="right">60</td>
<td align="right">4</td>
<td align="right">1.00</td>
<td align="right">28</td>
<td align="right">24.0</td>
<td align="right">2.97</td>
<td align="right">0</td>
<td align="right">1.2</td>
<td align="right">1.2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="right">12</td>
<td align="right">5339</td>
<td align="right">2.32</td>
<td align="right">36</td>
<td align="right">30.0</td>
<td align="right">3.61</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">1.5</td>
<td align="right">231</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="right">24</td>
<td align="right">378</td>
<td align="right">2.26</td>
<td align="right">37</td>
<td align="right">30.0</td>
<td align="right">3.46</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">94</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="right">36</td>
<td align="right">116</td>
<td align="right">1.37</td>
<td align="right">38</td>
<td align="right">32.0</td>
<td align="right">2.89</td>
<td align="right">0</td>
<td align="right">2.0</td>
<td align="right">2.0</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="right">48</td>
<td align="right">31</td>
<td align="right">2.10</td>
<td align="right">38</td>
<td align="right">32.0</td>
<td align="right">2.16</td>
<td align="right">0</td>
<td align="right">1.5</td>
<td align="right">2.0</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="right">60</td>
<td align="right">12</td>
<td align="right">3.00</td>
<td align="right">38</td>
<td align="right">34.0</td>
<td align="right">1.75</td>
<td align="right">0</td>
<td align="right">1.2</td>
<td align="right">1.8</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Patient characteristics. Abbreviations: Arm = arm of the study; R0 = no relapse during treatment; R1, R2 = the occurrence of relapse during the first and the second year of treatment, respectively; MRI = magnetic resonance imaging; M = months; n = number; F:M = female to male ratio; Age Symptoms = age at the first symptoms; Symptoms = duration from the first symptoms to prescription start in years; EDSS = The Expanded Disability Status Scale; Worsening number = number of patients with disease worsening.</p>
</div>
<div id="disease-progression-and-relapses" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-progression-and-relapses" class="anchor"></a>Disease progression and relapses</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="va">norlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">norlp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">Xpres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">norlp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">prescription</span><span class="op">)</span><span class="op">)</span>,
  drop <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="va">FUN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
  <span class="va">x</span>,
  <span class="va">criteria</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"worse"</span>, <span class="st">"dMRI_12m"</span><span class="op">)</span>,
  <span class="va">drug</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">case</span> <span class="op">=</span> <span class="cn">NA</span>, <span class="va">line</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">criteria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html">match.arg</a></span><span class="op">(</span><span class="va">criteria</span><span class="op">)</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">criteria</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">line</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">prescription</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="va">case</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>

  <span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="va">x</span> <span class="op">/</span> <span class="va">y</span><span class="op">$</span><span class="va">n</span>
  <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">y</span><span class="op">$</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">y</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>
  <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y</span><span class="op">$</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">y</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>
  <span class="va">y</span><span class="op">$</span><span class="va">up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">+</span> <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">+</span> <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="va">y</span><span class="op">$</span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">-</span> <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">y</span><span class="op">$</span><span class="va">p</span> <span class="op">-</span> <span class="va">y</span><span class="op">$</span><span class="va">halfCI</span>, <span class="fl">0</span><span class="op">)</span>

  <span class="va">y</span>

<span class="op">}</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) All"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xline</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) line"</span>, line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xpres</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) drug"</span>, line <span class="op">=</span> <span class="cn">TRUE</span>, drug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dtaplot</span>, <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.1</span><span class="op">)</span>

<span class="co"># Graph fine tuning.</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">48</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fl">0</span>,
    x <span class="op">=</span> <span class="cn">NA</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>,
      <span class="st">"II"</span>, <span class="st">"II"</span>
      <span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"GLA"</span>,
      <span class="st">""</span>, <span class="st">""</span>
      <span class="op">)</span>,
    case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>,
      <span class="st">"2) line"</span>, <span class="st">"2) line"</span>
      <span class="op">)</span>,
    lo <span class="op">=</span> <span class="cn">NA</span>,
    up <span class="op">=</span> <span class="cn">NA</span>,
    halfCI <span class="op">=</span> <span class="cn">NA</span>,
    p <span class="op">=</span> <span class="fl">0.001</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
    <span class="va">case</span> <span class="op">==</span> <span class="st">"1) All"</span>, <span class="st">"All"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">case</span> <span class="op">==</span> <span class="st">"2) line"</span>, <span class="va">line</span>, <span class="va">drug</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INF"</span>, <span class="st">"GLA"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"All"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1) All"</span>, <span class="st">"2) line"</span>, <span class="st">"3) drug"</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Line"</span>, <span class="st">"DMT"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">Colour</span>,
      fill <span class="op">=</span> <span class="va">Colour</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>,
    alpha <span class="op">=</span> <span class="fl">.8</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">15</span>, <span class="va">dtaplot</span><span class="op">$</span><span class="va">up</span> <span class="op">*</span><span class="fl">100</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">65</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span><span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Colour</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">.75</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    colour <span class="op">=</span> <span class="st">"white"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">60</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Freq. worsen disease (% "</span><span class="op">%+-%</span><span class="st">" std. err.)"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>
    <span class="va">case</span><span class="op">~</span><span class="va">.</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"none"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">gg</span>
<span class="co">#&gt; Warning: Removed 7 rows containing missing values (geom_text).</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_01-1.png" alt='**Figure 1.** Comparison between observed frequencies of worsening
    diseases and month of observation when no relapse was ever recorded.
    The upper pane uses the complete set of observations
    (green; label at y = 1 is "All"),
      the middle pane uses first- and second-line treatment
      (label at y = 1; first-line, dark brown; second-line, dark blue),
      and the lower pane uses drug
      (label at y = 1; Fingolimod, red, FTY; Glatiramer Acetate, dark blue,
        GLA; Interferon, blue, INF; Natalizumab, light brown, NAT).
      Abundance is represented by transparency and the figure at the top of
      each bar. The error bar represents the standard error estimated as
      p × (1 − p)/n, with p being the number of positives and n the total
      number of observations.  DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021.' width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 1.</strong> Comparison between observed frequencies of worsening diseases and month of observation when no relapse was ever recorded. The upper pane uses the complete set of observations (green; label at y = 1 is “All”), the middle pane uses first- and second-line treatment (label at y = 1; first-line, dark brown; second-line, dark blue), and the lower pane uses drug (label at y = 1; Fingolimod, red, FTY; Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF; Natalizumab, light brown, NAT). Abundance is represented by transparency and the figure at the top of each bar. The error bar represents the standard error estimated as p × (1 − p)/n, with p being the number of positives and n the total number of observations. DMT: disease-modifying therapy. See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>
<span class="va">onerlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1"</span><span class="op">)</span>
<span class="va">onebadrlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1+"</span><span class="op">)</span>
<span class="va">onelowrlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1-"</span><span class="op">)</span>

<span class="va">Xnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="va">norlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onerlp</span>, f <span class="op">=</span> <span class="va">onerlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xbr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onebadrlp</span>, f <span class="op">=</span> <span class="va">onebadrlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xlr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onelowrlp</span>, f <span class="op">=</span> <span class="va">onelowrlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xnr</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) R0"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xor</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) R1 (all)"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xbr</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) R1+ (severe)"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xlr</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"4) R1- (moderate)"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, 
  <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.15</span>  <span class="op">&amp;</span> <span class="op">(</span><span class="va">up</span> <span class="op">+</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">Time</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">36</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    x <span class="op">=</span> <span class="cn">NA</span>,
    line <span class="op">=</span> <span class="st">""</span>,
    drug <span class="op">=</span> <span class="st">""</span>,
    case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3) R1+ (severe)"</span>, <span class="st">"4) R1- (moderate)"</span><span class="op">)</span>,
    lo <span class="op">=</span> <span class="cn">NA</span>,
    up <span class="op">=</span> <span class="cn">NA</span>,
    halfCI <span class="op">=</span> <span class="cn">NA</span>,
    p <span class="op">=</span> <span class="fl">0.001</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">case</span>,
      fill <span class="op">=</span> <span class="va">case</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">15</span>, <span class="va">dtaplot</span><span class="op">$</span><span class="va">up</span> <span class="op">*</span><span class="fl">100</span><span class="op">+</span><span class="fl">3</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">41</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Freq. worsen disease (% "</span><span class="op">%+-%</span><span class="st">" std. err.)"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">gg</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_02-1.png" alt="**Figure 2**. Comparison of disease worsening and one relapse
      during the first year of treatment (between 6 and 12 months).
      Colors are for: R0 = no relapse, R1 = relapse during the first year.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021." width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 2</strong>. Comparison of disease worsening and one relapse during the first year of treatment (between 6 and 12 months). Colors are for: R0 = no relapse, R1 = relapse during the first year. See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
</div>
<div id="disease-progression-and-mri-activity" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-progression-and-mri-activity" class="anchor"></a>Disease progression and MRI Activity</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>
<span class="va">onerlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1"</span><span class="op">)</span>
<span class="va">oneY2rlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R2"</span><span class="op">)</span>

<span class="va">Xnr</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="va">norlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xor</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onerlp</span>, f <span class="op">=</span> <span class="va">onerlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">X2r</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">oneY2rlp</span>, f <span class="op">=</span> <span class="va">oneY2rlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xnr</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) R0"</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xor</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) R1 (all)"</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">X2r</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) R2"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>;

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, 
  <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.10</span>  <span class="op">&amp;</span> <span class="op">(</span><span class="va">up</span> <span class="op">+</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">Time</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">case</span>,
      fill <span class="op">=</span> <span class="va">case</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">15</span>, <span class="va">dtaplot</span><span class="op">$</span><span class="va">up</span> <span class="op">*</span><span class="fl">100</span><span class="op">+</span><span class="fl">3</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">41</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Freq. worsen disease (% "</span><span class="op">%+-%</span><span class="st">" std. err.)"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">gg</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_03-1.png" alt="**Figure 3**.
      Comparison between disease worsening and three scenarios:
      R0 (no relapse), R1 (relapse during the first year),
      and R2 (relapse during the second year).
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021." width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 3</strong>. Comparison between disease worsening and three scenarios: R0 (no relapse), R1 (relapse during the first year), and R2 (relapse during the second year). See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>
<span class="va">onerlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1"</span><span class="op">)</span>
<span class="va">oneY2rlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R2"</span><span class="op">)</span>

<span class="va">Xnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="va">norlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onerlp</span>, f <span class="op">=</span> <span class="va">onerlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">X2r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">oneY2rlp</span>, f <span class="op">=</span> <span class="va">oneY2rlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>

<span class="va">FUN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">drug</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">case</span> <span class="op">=</span> <span class="cn">NA</span>, <span class="va">line</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>,
    n    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,                    <span class="co"># n cases</span>
    x    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">dMRI_12m</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span>,                <span class="co"># positive cases</span>
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">line</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">prescription</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="va">case</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>;

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">y</span>,
    expr <span class="op">=</span> <span class="op">{</span>
      <span class="va">p</span>      <span class="op">&lt;-</span> <span class="va">x</span><span class="op">/</span><span class="va">n</span>;
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>
      <span class="va">up</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span>, <span class="fl">1</span><span class="op">)</span>
      <span class="va">lo</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span>, <span class="fl">0</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>

<span class="op">}</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xnr</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) R0"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xor</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) R1"</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">X2r</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) R2"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, 
  <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.10</span>  <span class="op">&amp;</span> <span class="op">(</span><span class="va">up</span> <span class="op">+</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">Time</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fl">36</span>,
    n <span class="op">=</span> <span class="fl">0</span>,
    x <span class="op">=</span> <span class="cn">NA</span>,
    line <span class="op">=</span> <span class="st">""</span>,
    drug <span class="op">=</span> <span class="st">""</span>,
    case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2) R1"</span><span class="op">)</span>,
    lo <span class="op">=</span> <span class="cn">NA</span>,
    up <span class="op">=</span> <span class="cn">NA</span>,
    halfCI <span class="op">=</span> <span class="cn">NA</span>,
    p <span class="op">=</span> <span class="fl">0.002</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">case</span>,
      fill <span class="op">=</span> <span class="va">case</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fl">15</span>, <span class="va">dtaplot</span><span class="op">$</span><span class="va">up</span> <span class="op">*</span><span class="fl">100</span><span class="op">+</span><span class="fl">3</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">41</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Freq. worsen disease (% "</span><span class="op">%+-%</span><span class="st">" std. err.)"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="op">}</span>

<span class="va">gg</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_04-1.png" alt="**Figure 4**.
      Comparison between MRI activity and the three scenarios:
      R0 (no relapse), R1 (relapse during the first year), and
      R2 (relapse during the second year).
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021." width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 4</strong>. Comparison between MRI activity and the three scenarios: R0 (no relapse), R1 (relapse during the first year), and R2 (relapse during the second year). See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#[FC/200121/14:45]# graph MRI worsening? </span>

<span class="va">norlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>

<span class="va">X</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="va">norlp</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">norlp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Xpres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">norlp</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">norlp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">prescription</span><span class="op">)</span><span class="op">)</span>,
  drop <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="va">FUN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">drug</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">case</span> <span class="op">=</span> <span class="cn">NA</span>, <span class="va">line</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>,
    n    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,                            <span class="co"># n cases</span>
    x    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">dMRI_12m</span> <span class="op">&gt;=</span><span class="fl">1</span><span class="op">)</span>,                <span class="co"># positive cases</span>
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">line</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">prescription</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="va">case</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>;

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">y</span>,
    expr <span class="op">=</span> <span class="op">{</span>
      <span class="va">p</span>      <span class="op">&lt;-</span> <span class="va">x</span><span class="op">/</span><span class="va">n</span>;
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>;
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>;
      <span class="va">up</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span>, <span class="fl">1</span><span class="op">)</span>;
      <span class="va">lo</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span>, <span class="fl">0</span><span class="op">)</span>;
    <span class="op">}</span>
    <span class="op">)</span>;

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>;

<span class="op">}</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) All"</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xline</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) line"</span>, line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xpres</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) drug"</span>, line <span class="op">=</span> <span class="cn">TRUE</span>, drug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, 
  <span class="op">!</span><span class="op">(</span><span class="va">drug</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DMF"</span>, <span class="st">"PEG"</span><span class="op">)</span><span class="op">)</span> 
  <span class="op">&amp;</span> <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.1</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">48</span>, <span class="fl">48</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fl">0</span>,
    x <span class="op">=</span> <span class="cn">NA</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"II"</span>, <span class="st">"II"</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GLA"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"GLA"</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>,
      <span class="st">"2) line"</span>, <span class="st">"2) line"</span>
      <span class="op">)</span>,
    lo <span class="op">=</span> <span class="cn">NA</span>,
    up <span class="op">=</span> <span class="cn">NA</span>,
    halfCI <span class="op">=</span> <span class="cn">NA</span>,
    p <span class="op">=</span> <span class="fl">0.001</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
    <span class="va">case</span> <span class="op">==</span> <span class="st">"1) All"</span>, <span class="st">"All"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">case</span> <span class="op">==</span> <span class="st">"2) line"</span>, <span class="va">line</span>, <span class="va">drug</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INF"</span>, <span class="st">"GLA"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"All"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1) All"</span>, <span class="st">"2) line"</span>, <span class="st">"3) drug"</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Line"</span>, <span class="st">"DMT"</span><span class="op">)</span>
<span class="op">)</span>


<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">Colour</span>,
      fill <span class="op">=</span> <span class="va">Colour</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>,
    alpha <span class="op">=</span> <span class="fl">.8</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">32</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">65</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span><span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Colour</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    colour <span class="op">=</span> <span class="st">"white"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">60</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="st">"Freq. MRI activity (%, +/- std. err.)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>
    <span class="va">case</span><span class="op">~</span><span class="va">.</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"none"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">gg</span>
<span class="co">#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_05-1.png" alt="**Figure 5.** Comparison between the observed frequencies of MRI
      activity and month of observation when no relapse was
      ever recorded. The upper pane uses the complete set of observations
      (green; label at y = 1 is “All”), the middle pane uses
      first- and second-line treatment (label at y = 1; first-line, dark brown;
        second-line, dark blue), and the lower pane uses the
      drug (label at y = 1; Fingolimod, red, FTY;
        Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF; Natalizumab,
        light brown, NAT). DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021." width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 5.</strong> Comparison between the observed frequencies of MRI activity and month of observation when no relapse was ever recorded. The upper pane uses the complete set of observations (green; label at y = 1 is “All”), the middle pane uses first- and second-line treatment (label at y = 1; first-line, dark brown; second-line, dark blue), and the lower pane uses the drug (label at y = 1; Fingolimod, red, FTY; Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF; Natalizumab, light brown, NAT). DMT: disease-modifying therapy. See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
</div>
<div id="disease-progression-relapses-and-mri-activity" class="section level3">
<h3 class="hasAnchor">
<a href="#disease-progression-relapses-and-mri-activity" class="anchor"></a>Disease progression: relapses and MRI Activity</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pirma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0+MRI0"</span><span class="op">)</span>
<span class="va">X</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pirma</span>, f <span class="op">=</span> <span class="va">pirma</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>
<span class="va">Xline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pirma</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">pirma</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">Xpres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">pirma</span>, f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">pirma</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">presc_months_cat</span>, <span class="va">prescription</span><span class="op">)</span><span class="op">)</span>,
  drop <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="va">FUN</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">drug</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">case</span> <span class="op">=</span> <span class="cn">NA</span>, <span class="va">line</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span>

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">presc_months_cat</span><span class="op">)</span>,
    n    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,                    <span class="co"># n cases</span>
    x    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">worse</span><span class="op">)</span>,               <span class="co"># positive cases</span>
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">line</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">treatment_line</span><span class="op">)</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">prescription</span><span class="op">)</span>, <span class="st">''</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="va">case</span>,
    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>;

  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">y</span>,
    expr <span class="op">=</span> <span class="op">{</span>
      <span class="va">p</span>      <span class="op">&lt;-</span> <span class="va">x</span><span class="op">/</span><span class="va">n</span>;
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>;
      <span class="va">halfCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="va">n</span><span class="op">)</span>;
      <span class="va">up</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="va">p</span> <span class="op">+</span> <span class="va">halfCI</span>, <span class="fl">1</span><span class="op">)</span>;
      <span class="va">lo</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">p</span> <span class="op">-</span> <span class="va">halfCI</span>, <span class="fl">0</span><span class="op">)</span>;
    <span class="op">}</span>
    <span class="op">)</span>;

  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>;

<span class="op">}</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"1) All"</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xline</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"2) line"</span>, line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  , <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">Xpres</span>, <span class="va">FUN</span>, case <span class="op">=</span> <span class="st">"3) drug"</span>, line <span class="op">=</span> <span class="cn">TRUE</span>, drug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>;

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, 
  <span class="op">!</span><span class="op">(</span><span class="va">drug</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DMF"</span>, <span class="st">"PEG"</span><span class="op">)</span><span class="op">)</span> 
  <span class="op">&amp;</span> <span class="op">(</span><span class="va">up</span> <span class="op">-</span> <span class="va">lo</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.1</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">48</span>, <span class="fl">48</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span>,
    n <span class="op">=</span> <span class="fl">0</span>,
    x <span class="op">=</span> <span class="cn">NA</span>,
    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"II"</span>, <span class="st">"II"</span><span class="op">)</span>,
    drug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GLA"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"GLA"</span>, <span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,
    case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>, <span class="st">"3) drug"</span>,
      <span class="st">"2) line"</span>, <span class="st">"2) line"</span>
      <span class="op">)</span>,
    lo <span class="op">=</span> <span class="cn">NA</span>,
    up <span class="op">=</span> <span class="cn">NA</span>,
    halfCI <span class="op">=</span> <span class="cn">NA</span>,
    p <span class="op">=</span> <span class="fl">0.0005</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
    <span class="va">case</span> <span class="op">==</span> <span class="st">"1) All"</span>, <span class="st">"All"</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">case</span> <span class="op">==</span> <span class="st">"2) line"</span>, <span class="va">line</span>, <span class="va">drug</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">Colour</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INF"</span>, <span class="st">"GLA"</span>, <span class="st">"FTY"</span>, <span class="st">"NAT"</span>, <span class="st">"I"</span>, <span class="st">"II"</span>, <span class="st">"All"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  <span class="va">dtaplot</span><span class="op">$</span><span class="va">case</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1) All"</span>, <span class="st">"2) line"</span>, <span class="st">"3) drug"</span><span class="op">)</span>,
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Line"</span>, <span class="st">"DMT"</span><span class="op">)</span>
<span class="op">)</span>


<span class="va">gg</span> <span class="op">&lt;-</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">dtaplot</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">p</span>,
      size <span class="op">=</span> <span class="va">n</span>,
      colour <span class="op">=</span> <span class="va">Colour</span>,
      fill <span class="op">=</span> <span class="va">Colour</span>,
      label <span class="op">=</span> <span class="va">n</span>,
      ymax <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span>, ymin <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">lo</span>
    <span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>
    position <span class="op">=</span> <span class="st">"dodge"</span>,
    color <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">9.5</span>,
    alpha <span class="op">=</span> <span class="fl">.8</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">.5</span>, alpha <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"gray45"</span> 
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html">scale_alpha_continuous</a></span><span class="op">(</span>
    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">.3</span>, max <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>
    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.75</span>, <span class="fl">12</span><span class="op">)</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">65</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">up</span><span class="op">)</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fontface <span class="op">=</span> <span class="st">"italic"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Colour</span><span class="op">)</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">.75</span>,
    alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">9.5</span><span class="op">)</span>,
    colour <span class="op">=</span> <span class="st">"white"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span> , <span class="fl">60</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"Freq. worsen disease (% "</span><span class="op">%+-%</span><span class="st">" std. err.)"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>
    <span class="st">"Time since prescription start (months)"</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>
    <span class="va">case</span><span class="op">~</span><span class="va">.</span>
    <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"none"</span>,
    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>;
<span class="op">}</span>

<span class="va">gg</span>
<span class="co">#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span></code></pre></div>
<div class="figure">
<p><img src="reference/figures/README-fig_06-1.png" alt="**Figure 6**. Patients with evidenced disease progression:
      the proportion of estimations derived from observation of patients
      never associated with any relapses or brain MRI activity between 12
      and 60 months from the prescription start. The upper
      pane uses the complete set of observations
      (green; label at y = 1 is “All”), the middle pane uses first- and
      second-line treatment (label at y = 1; first-line, dark brown;
        second-line, dark blue), and the lower pane uses the drug
      (label at y = 1; Fingolimod, red, FTY;
        Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF;
        Natalizumab, light brown, NAT). The
      error bar represents the standard error estimated asp × (1 − p)/n,
      with p being the number of positives and n the total
      number of observations. DMT: disease-modifying therapy.
      See &lt;https://www.mdpi.com/2077-0383/10/4/868&gt;,
      @Kapica-Topczewska2021." width="100%"></p>
<p class="caption">
</p>
<p><strong>Figure 6</strong>. Patients with evidenced disease progression: the proportion of estimations derived from observation of patients never associated with any relapses or brain MRI activity between 12 and 60 months from the prescription start. The upper pane uses the complete set of observations (green; label at y = 1 is “All”), the middle pane uses first- and second-line treatment (label at y = 1; first-line, dark brown; second-line, dark blue), and the lower pane uses the drug (label at y = 1; Fingolimod, red, FTY; Glatiramer Acetate, dark blue, GLA; Interferon, blue, INF; Natalizumab, light brown, NAT). The error bar represents the standard error estimated asp × (1 − p)/n, with p being the number of positives and n the total number of observations. DMT: disease-modifying therapy. See <a href="https://www.mdpi.com/2077-0383/10/4/868" class="uri">https://www.mdpi.com/2077-0383/10/4/868</a>, Kapica-Topczewska et al. (2021).</p>

</div>
</div>
<div id="modele-probability-of-disease-worsening" class="section level3">
<h3 class="hasAnchor">
<a href="#modele-probability-of-disease-worsening" class="anchor"></a>Modele: Probability of Disease Worsening</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># &gt; "*overdispersion when residual deviance is larger than residual degrees of</span>
<span class="co"># &gt; freedom*" [@Crawley2013]</span>

<span class="va">res_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#[FC/200728/07:18]# R0 {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R0</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0"</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R0</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">EDSS</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R0</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200728/07:18]# R1 {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R1</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1"</span> <span class="op">&amp;</span> <span class="op">!</span> <span class="va">presc_months_cat</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R1</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">line</span> <span class="op">+</span> <span class="va">sex</span><span class="op">)</span>
  <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">sex</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">drug</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">line</span> <span class="op">-</span><span class="va">line</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">age</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">EDSS</span> <span class="op">-</span><span class="va">age</span>,
  data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R1</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC 200807 07:14]# R1+ {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R1+`</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1+"</span> <span class="op">&amp;</span> <span class="op">!</span> <span class="va">presc_months_cat</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R1+`</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">sex</span>,
  <span class="co">#   worse ~ Time * (age + EDSS + line + sex + drug)</span>
  <span class="co">#   -Time:line -Time:EDSS -Time:age -line -Time:drug -drug -age -Time:sex,</span>
  data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R1+`</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC 200807 07:14]# R1- {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R1-`</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R1-"</span> <span class="op">&amp;</span> <span class="op">!</span> <span class="va">presc_months_cat</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">48</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R1-`</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span>,
  data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R1-`</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200728/07:18]# R2 {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R2</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R2"</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">R2</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">sex</span><span class="op">)</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">age</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">line</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">drug</span>
  <span class="op">-</span><span class="va">drug</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">sex</span> <span class="op">-</span><span class="va">sex</span> <span class="op">-</span><span class="va">Time</span><span class="op">:</span><span class="va">EDSS</span>, 
  data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R2</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200728/07:18]# R0+MRI0 {{{</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R0+MRI0`</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ADPIRA</span>, <span class="va">ARMCD</span> <span class="op">==</span> <span class="st">"R0+MRI0"</span><span class="op">)</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
      Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">presc_months_cat</span><span class="op">)</span>,
      ARMCD <span class="op">=</span> <span class="va">ARMCD</span>,
      line <span class="op">=</span> <span class="va">treatment_line</span>,
      drug <span class="op">=</span> <span class="va">prescription</span>,
      sex <span class="op">=</span> <span class="va">sex</span>,
      age <span class="op">=</span> <span class="va">age</span>,
      EDSS <span class="op">=</span> <span class="va">EDSS_start</span>,
      <span class="va">worse</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">res_glm</span><span class="op">$</span><span class="va">`R0+MRI0`</span><span class="op">$</span><span class="va">glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>
  <span class="va">worse</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">EDSS</span>,
  data <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R0+MRI0`</span><span class="op">$</span><span class="va">data</span>,
  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"line"</span>, <span class="st">"drug"</span>, <span class="st">"age"</span>, <span class="st">"EDSS"</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">res_glm</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">glm</span><span class="op">)</span>

<span class="va">devianceTables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  <span class="va">X</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>

    <span class="va">covariates</span> <span class="op">&lt;-</span> <span class="va">covariates</span><span class="op">[</span><span class="op">!</span> <span class="va">covariates</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"term.labels"</span><span class="op">)</span><span class="op">]</span>

    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
      <span class="va">covariates</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">effect</span> <span class="op">&lt;-</span> <span class="va">y</span>
        <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">" . ~ . +"</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
        <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
          <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[#] "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"term.labels"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span><span class="op">)</span>
          , <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"# + "</span>, <span class="va">effect</span><span class="op">)</span><span class="op">)</span>
        <span class="va">y</span>
      <span class="op">}</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>

  <span class="op">}</span>
<span class="op">)</span>

<span class="va">devianceTables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Map</a></span><span class="op">(</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">tbl</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
      Arm <span class="op">=</span> <span class="va">name</span>,
      Covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span>,
      <span class="va">tbl</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    <span class="va">tbl</span>
  <span class="op">}</span>,
  <span class="va">devianceTables</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">devianceTables</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">devianceTables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">devianceTables</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">devianceTables</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>
  <span class="va">devianceTables</span>,
  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>
    <span class="st">"Candiadate covariates. "</span>,
    <span class="st">"The deviance table compares within each Arm the deviance of "</span>,
    <span class="st">"the model [#] to the model including an additional covariate (#+)."</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Arm</th>
<th align="left">Covariates</th>
<th align="right">Resid. Df</th>
<th align="right">Resid. Dev</th>
<th align="right">Df</th>
<th align="right">Deviance</th>
<th align="right">Pr(&gt;Chi)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">R0</td>
<td align="left">
<br><span class="math display">#</span><br> Time+age+EDSS</td>
<td align="right">10465</td>
<td align="right">4331.6046</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="left"># + sex</td>
<td align="right">10464</td>
<td align="right">4331.2730</td>
<td align="right">1</td>
<td align="right">0.3315723</td>
<td align="right">0.5647347</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="left"># + line</td>
<td align="right">10464</td>
<td align="right">4329.0596</td>
<td align="right">1</td>
<td align="right">2.5450096</td>
<td align="right">0.1106432</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="left"># + drug</td>
<td align="right">10462</td>
<td align="right">4327.1385</td>
<td align="right">3</td>
<td align="right">4.4660468</td>
<td align="right">0.2153389</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="left">
<br><span class="math display">#</span><br> Time+EDSS+sex</td>
<td align="right">803</td>
<td align="right">661.1765</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="left"># + line</td>
<td align="right">802</td>
<td align="right">661.1756</td>
<td align="right">1</td>
<td align="right">0.0009201</td>
<td align="right">0.9758010</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="left"># + drug</td>
<td align="right">800</td>
<td align="right">660.5379</td>
<td align="right">3</td>
<td align="right">0.6386538</td>
<td align="right">0.8875292</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="left"># + age</td>
<td align="right">802</td>
<td align="right">658.5293</td>
<td align="right">1</td>
<td align="right">2.6472572</td>
<td align="right">0.1037287</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="left">
<br><span class="math display">#</span><br> Time+EDSS+sex</td>
<td align="right">433</td>
<td align="right">474.3609</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="left"># + line</td>
<td align="right">432</td>
<td align="right">473.7767</td>
<td align="right">1</td>
<td align="right">0.5842904</td>
<td align="right">0.4446355</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="left"># + drug</td>
<td align="right">430</td>
<td align="right">473.4962</td>
<td align="right">3</td>
<td align="right">0.8647174</td>
<td align="right">0.8339329</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="left"># + age</td>
<td align="right">432</td>
<td align="right">473.6428</td>
<td align="right">1</td>
<td align="right">0.7181511</td>
<td align="right">0.3967510</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="left">
<br><span class="math display">#</span><br> Time</td>
<td align="right">328</td>
<td align="right">120.8864</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="left"># + sex</td>
<td align="right">327</td>
<td align="right">120.8734</td>
<td align="right">1</td>
<td align="right">0.0129546</td>
<td align="right">0.9093820</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="left"># + line</td>
<td align="right">327</td>
<td align="right">120.6265</td>
<td align="right">1</td>
<td align="right">0.2598883</td>
<td align="right">0.6101969</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="left"># + drug</td>
<td align="right">325</td>
<td align="right">117.0125</td>
<td align="right">3</td>
<td align="right">3.8738161</td>
<td align="right">0.2754160</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="left"># + age</td>
<td align="right">327</td>
<td align="right">118.9841</td>
<td align="right">1</td>
<td align="right">1.9023100</td>
<td align="right">0.1678200</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="left"># + EDSS</td>
<td align="right">327</td>
<td align="right">120.8557</td>
<td align="right">1</td>
<td align="right">0.0307115</td>
<td align="right">0.8608857</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="left">
<br><span class="math display">#</span><br> Time+age+EDSS</td>
<td align="right">5869</td>
<td align="right">2415.0556</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left"># + sex</td>
<td align="right">5868</td>
<td align="right">2414.7703</td>
<td align="right">1</td>
<td align="right">0.2852875</td>
<td align="right">0.5932564</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="left"># + line</td>
<td align="right">5868</td>
<td align="right">2415.0038</td>
<td align="right">1</td>
<td align="right">0.0517659</td>
<td align="right">0.8200186</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left"># + drug</td>
<td align="right">5866</td>
<td align="right">2413.0608</td>
<td align="right">3</td>
<td align="right">1.9947361</td>
<td align="right">0.5735000</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left">
<br><span class="math display">#</span><br> Time+age+EDSS</td>
<td align="right">7374</td>
<td align="right">3057.5957</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="left"># + sex</td>
<td align="right">7373</td>
<td align="right">3056.4273</td>
<td align="right">1</td>
<td align="right">1.1683623</td>
<td align="right">0.2797380</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left"># + line</td>
<td align="right">7373</td>
<td align="right">3056.5877</td>
<td align="right">1</td>
<td align="right">1.0080140</td>
<td align="right">0.3153791</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="left"># + drug</td>
<td align="right">7371</td>
<td align="right">3055.8399</td>
<td align="right">3</td>
<td align="right">1.7557917</td>
<td align="right">0.6246021</td>
</tr>
</tbody>
</table>
<p>Candiadate covariates. The deviance table compares within each Arm the deviance of the model <br><span class="math display">#</span><br> to the model including an additional covariate (#+).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">res_glm</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">glm</span><span class="op">)</span>

<span class="va">effectTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="va">X</span>,
  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">x</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="va">effectTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Map</a></span><span class="op">(</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">tbl</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
      Arm <span class="op">=</span> <span class="va">name</span>,
      <span class="va">tbl</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    <span class="va">tbl</span>
  <span class="op">}</span>,
  <span class="va">effectTest</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">effectTest</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">effectTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">effectTest</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">effectTest</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>
  <span class="va">effectTest</span>,
  caption <span class="op">=</span> <span class="st">"Effect tests."</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="14%">
<col width="11%">
<col width="11%">
<col width="15%">
<col width="11%">
<col width="11%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">Arm</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">R0</td>
<td align="left">(Intercept)</td>
<td align="right">0.0159099</td>
<td align="right">0.1758165</td>
<td align="right">-23.5519260</td>
<td align="right">0.0000000</td>
<td align="right">0.0112342</td>
<td align="right">0.0223827</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="left">Time24</td>
<td align="right">1.4400976</td>
<td align="right">0.1019537</td>
<td align="right">3.5772217</td>
<td align="right">0.0003473</td>
<td align="right">1.1783074</td>
<td align="right">1.7577058</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="left">Time36</td>
<td align="right">1.5530080</td>
<td align="right">0.1272181</td>
<td align="right">3.4601487</td>
<td align="right">0.0005399</td>
<td align="right">1.2053054</td>
<td align="right">1.9857485</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="left">Time48</td>
<td align="right">1.7683206</td>
<td align="right">0.1786472</td>
<td align="right">3.1908166</td>
<td align="right">0.0014187</td>
<td align="right">1.2298044</td>
<td align="right">2.4816719</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="left">Time60</td>
<td align="right">1.9133241</td>
<td align="right">0.2389880</td>
<td align="right">2.7149566</td>
<td align="right">0.0066284</td>
<td align="right">1.1652859</td>
<td align="right">2.9874159</td>
</tr>
<tr class="even">
<td align="left">R0</td>
<td align="left">age</td>
<td align="right">1.0336151</td>
<td align="right">0.0042812</td>
<td align="right">7.7226589</td>
<td align="right">0.0000000</td>
<td align="right">1.0249880</td>
<td align="right">1.0423384</td>
</tr>
<tr class="odd">
<td align="left">R0</td>
<td align="left">EDSS</td>
<td align="right">0.8859283</td>
<td align="right">0.0377181</td>
<td align="right">-3.2111738</td>
<td align="right">0.0013219</td>
<td align="right">0.8221604</td>
<td align="right">0.9531646</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="left">(Intercept)</td>
<td align="right">0.3915201</td>
<td align="right">0.2156065</td>
<td align="right">-4.3492128</td>
<td align="right">0.0000137</td>
<td align="right">0.2551541</td>
<td align="right">0.5947259</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="left">Time24</td>
<td align="right">0.5818220</td>
<td align="right">0.2836181</td>
<td align="right">-1.9095769</td>
<td align="right">0.0561877</td>
<td align="right">0.3238569</td>
<td align="right">0.9906386</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="left">Time36</td>
<td align="right">0.3929735</td>
<td align="right">0.4830662</td>
<td align="right">-1.9335094</td>
<td align="right">0.0531735</td>
<td align="right">0.1337507</td>
<td align="right">0.9242070</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="left">EDSS</td>
<td align="right">0.6860285</td>
<td align="right">0.0867892</td>
<td align="right">-4.3419709</td>
<td align="right">0.0000141</td>
<td align="right">0.5762608</td>
<td align="right">0.8100402</td>
</tr>
<tr class="even">
<td align="left">R1</td>
<td align="left">sexmale</td>
<td align="right">1.7202530</td>
<td align="right">0.2046138</td>
<td align="right">2.6511962</td>
<td align="right">0.0080207</td>
<td align="right">1.1481310</td>
<td align="right">2.5643997</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="left">(Intercept)</td>
<td align="right">0.5791392</td>
<td align="right">0.2417755</td>
<td align="right">-2.2591721</td>
<td align="right">0.0238727</td>
<td align="right">0.3585056</td>
<td align="right">0.9268643</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="left">Time24</td>
<td align="right">0.6748859</td>
<td align="right">0.3219724</td>
<td align="right">-1.2212586</td>
<td align="right">0.2219881</td>
<td align="right">0.3485051</td>
<td align="right">1.2404674</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="left">Time36</td>
<td align="right">0.7176105</td>
<td align="right">0.5300170</td>
<td align="right">-0.6260710</td>
<td align="right">0.5312684</td>
<td align="right">0.2279344</td>
<td align="right">1.8986711</td>
</tr>
<tr class="even">
<td align="left">R1+</td>
<td align="left">EDSS</td>
<td align="right">0.7108579</td>
<td align="right">0.1002566</td>
<td align="right">-3.4040927</td>
<td align="right">0.0006638</td>
<td align="right">0.5815889</td>
<td align="right">0.8622552</td>
</tr>
<tr class="odd">
<td align="left">R1+</td>
<td align="left">sexmale</td>
<td align="right">1.7792792</td>
<td align="right">0.2315053</td>
<td align="right">2.4889635</td>
<td align="right">0.0128116</td>
<td align="right">1.1283132</td>
<td align="right">2.8007257</td>
</tr>
<tr class="even">
<td align="left">R1-</td>
<td align="left">(Intercept)</td>
<td align="right">0.0548523</td>
<td align="right">0.2848552</td>
<td align="right">-10.1915316</td>
<td align="right">0.0000000</td>
<td align="right">0.0298083</td>
<td align="right">0.0918916</td>
</tr>
<tr class="odd">
<td align="left">R1-</td>
<td align="left">Time24</td>
<td align="right">0.4674556</td>
<td align="right">0.7706830</td>
<td align="right">-0.9867233</td>
<td align="right">0.3237783</td>
<td align="right">0.0720818</td>
<td align="right">1.7408554</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">(Intercept)</td>
<td align="right">0.0218705</td>
<td align="right">0.2136566</td>
<td align="right">-17.8914021</td>
<td align="right">0.0000000</td>
<td align="right">0.0143089</td>
<td align="right">0.0330734</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="left">Time24</td>
<td align="right">7.9402682</td>
<td align="right">0.1396443</td>
<td align="right">14.8373222</td>
<td align="right">0.0000000</td>
<td align="right">6.0225925</td>
<td align="right">10.4173481</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">Time36</td>
<td align="right">3.7069769</td>
<td align="right">0.2806290</td>
<td align="right">4.6688566</td>
<td align="right">0.0000030</td>
<td align="right">2.0660900</td>
<td align="right">6.2515608</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="left">Time48</td>
<td align="right">4.1959623</td>
<td align="right">0.4970106</td>
<td align="right">2.8854975</td>
<td align="right">0.0039080</td>
<td align="right">1.4006973</td>
<td align="right">10.2462266</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">Time60</td>
<td align="right">6.6066892</td>
<td align="right">0.6763177</td>
<td align="right">2.7917095</td>
<td align="right">0.0052430</td>
<td align="right">1.4455332</td>
<td align="right">22.6271134</td>
</tr>
<tr class="odd">
<td align="left">R2</td>
<td align="left">age</td>
<td align="right">1.0318529</td>
<td align="right">0.0054831</td>
<td align="right">5.7186566</td>
<td align="right">0.0000000</td>
<td align="right">1.0208436</td>
<td align="right">1.0430317</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">EDSS</td>
<td align="right">0.7658628</td>
<td align="right">0.0527791</td>
<td align="right">-5.0541242</td>
<td align="right">0.0000004</td>
<td align="right">0.6896365</td>
<td align="right">0.8481670</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left">(Intercept)</td>
<td align="right">0.0161072</td>
<td align="right">0.2152669</td>
<td align="right">-19.1784490</td>
<td align="right">0.0000000</td>
<td align="right">0.0105102</td>
<td align="right">0.0244448</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="left">Time24</td>
<td align="right">1.5283783</td>
<td align="right">0.1203618</td>
<td align="right">3.5244344</td>
<td align="right">0.0004244</td>
<td align="right">1.2056012</td>
<td align="right">1.9333330</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left">Time36</td>
<td align="right">1.7960316</td>
<td align="right">0.1500578</td>
<td align="right">3.9023595</td>
<td align="right">0.0000953</td>
<td align="right">1.3306328</td>
<td align="right">2.3983973</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="left">Time48</td>
<td align="right">2.1191364</td>
<td align="right">0.2180215</td>
<td align="right">3.4446541</td>
<td align="right">0.0005718</td>
<td align="right">1.3554449</td>
<td align="right">3.1961796</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left">Time60</td>
<td align="right">1.7760974</td>
<td align="right">0.3258114</td>
<td align="right">1.7630401</td>
<td align="right">0.0778937</td>
<td align="right">0.8868399</td>
<td align="right">3.2193851</td>
</tr>
<tr class="even">
<td align="left">R0+MRI0</td>
<td align="left">age</td>
<td align="right">1.0347541</td>
<td align="right">0.0051807</td>
<td align="right">6.5944005</td>
<td align="right">0.0000000</td>
<td align="right">1.0243201</td>
<td align="right">1.0453413</td>
</tr>
<tr class="odd">
<td align="left">R0+MRI0</td>
<td align="left">EDSS</td>
<td align="right">0.8318432</td>
<td align="right">0.0446721</td>
<td align="right">-4.1213939</td>
<td align="right">0.0000377</td>
<td align="right">0.7613255</td>
<td align="right">0.9070329</td>
</tr>
</tbody>
</table>
<p>Effect tests.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>EDSS <span class="op">=</span> <span class="fl">2</span>, age <span class="op">=</span> <span class="fl">30</span>, sex <span class="op">=</span> <span class="st">"female"</span><span class="op">)</span>

<span class="va">em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#[FC/200804/12:56]# R0 {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">R0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span><span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R0</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
      <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">em</span><span class="op">$</span><span class="va">R0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">R0</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[EDSS="</span>, <span class="va">EDSS</span>, <span class="st">"] [Age="</span>, <span class="va">age</span>, <span class="st">"]"</span><span class="op">)</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"R0"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200804/12:57]# R1 {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">R1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span>
    <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R1</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; NOTE: A nesting structure was detected in the fitted model:</span>
<span class="co">#&gt;     drug %in% line</span>

<span class="va">em</span><span class="op">$</span><span class="va">R1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">R1</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[EDSS="</span>, <span class="va">EDSS</span>, <span class="st">"] [Sex="</span>, <span class="va">sex</span>, <span class="st">"]"</span><span class="op">)</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"R1"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200804/12:57]# R1+ {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R1+`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span>
    <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R1+`</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R1+`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">`R1+`</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[EDSS="</span>, <span class="va">EDSS</span>, <span class="st">"] [Sex="</span>, <span class="va">sex</span>, <span class="st">"]"</span><span class="op">)</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"`R1+`"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200804/12:57]# R1- {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R1-`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span>
    <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R1-`</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R1-`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">`R1-`</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="st">"none"</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"`R1-`"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200804/12:57]# R2 {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span>
    <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">R2</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
      <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; NOTE: A nesting structure was detected in the fitted model:</span>
<span class="co">#&gt;     drug %in% line</span>

<span class="va">em</span><span class="op">$</span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">R2</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[EDSS="</span>, <span class="va">EDSS</span>, <span class="st">"] [Age="</span>, <span class="va">age</span>, <span class="st">"]"</span><span class="op">)</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"R2"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>
<span class="co">#[FC/200804/12:57]# `R0+MRI0` {{{</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R0+MRI0`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span>
  <span class="fu">multcomp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span>
    <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span>
      object <span class="op">=</span> <span class="va">res_glm</span><span class="op">$</span><span class="va">`R0+MRI0`</span><span class="op">$</span><span class="va">glm</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">EDSS</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">Time</span>, at <span class="op">=</span> <span class="va">at</span>,
      type <span class="op">=</span> <span class="st">"response"</span>
      <span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">em</span><span class="op">$</span><span class="va">`R0+MRI0`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span>
  <span class="va">em</span><span class="op">$</span><span class="va">`R0+MRI0`</span>,
  expr <span class="op">=</span> <span class="op">{</span>
    <span class="va">covariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"[EDSS="</span>, <span class="va">EDSS</span>, <span class="st">"] [Age="</span>, <span class="va">age</span>, <span class="st">"]"</span><span class="op">)</span>
    <span class="va">Arm</span> <span class="op">&lt;-</span> <span class="st">"R0+MRI0"</span>
  <span class="op">}</span>
<span class="op">)</span>

<span class="co">###}}} -- vim fold</span>

<span class="va">em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
  <span class="va">rbind</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="va">em</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">x</span><span class="op">[</span>
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
          <span class="st">"Arm"</span>, <span class="st">"Time"</span>, <span class="st">"covariate"</span>, <span class="st">"prob"</span>,
          <span class="st">"SE"</span>, <span class="st">"asymp.LCL"</span>, <span class="st">"asymp.UCL"</span>, <span class="st">".group"</span>
        <span class="op">)</span>
        <span class="op">]</span>
    <span class="op">}</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">em</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="va">em</span> <span class="op">&lt;-</span> <span class="va">em</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">em</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">Arm</span>, <span class="va">Time</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">em</span>, caption <span class="op">=</span> <span class="st">"Adjusted Means."</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Arm</th>
<th align="left">Time</th>
<th align="left">covariate</th>
<th align="right">prob</th>
<th align="right">SE</th>
<th align="right">asymp.LCL</th>
<th align="right">asymp.UCL</th>
<th align="left">.group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">13</td>
<td align="left"><code>R1-</code></td>
<td align="left">12</td>
<td align="left">none</td>
<td align="right">0.0520000</td>
<td align="right">0.0140422</td>
<td align="right">0.0304302</td>
<td align="right">0.0874796</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left"><code>R1-</code></td>
<td align="left">24</td>
<td align="left">none</td>
<td align="right">0.0250000</td>
<td align="right">0.0174551</td>
<td align="right">0.0062612</td>
<td align="right">0.0944889</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left"><code>R1+</code></td>
<td align="left">12</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.2263954</td>
<td align="right">0.0269793</td>
<td align="right">0.1778916</td>
<td align="right">0.2835626</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left"><code>R1+</code></td>
<td align="left">24</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.1649307</td>
<td align="right">0.0430242</td>
<td align="right">0.0967166</td>
<td align="right">0.2670332</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left"><code>R1+</code></td>
<td align="left">36</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.1735597</td>
<td align="right">0.0756538</td>
<td align="right">0.0695020</td>
<td align="right">0.3712522</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">R0</td>
<td align="left">12</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0325722</td>
<td align="right">0.0025535</td>
<td align="right">0.0279224</td>
<td align="right">0.0379660</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">R0</td>
<td align="left">24</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0462442</td>
<td align="right">0.0039531</td>
<td align="right">0.0390854</td>
<td align="right">0.0546398</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">R0</td>
<td align="left">36</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0496898</td>
<td align="right">0.0055526</td>
<td align="right">0.0398696</td>
<td align="right">0.0617734</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">R0</td>
<td align="left">48</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0561919</td>
<td align="right">0.0091343</td>
<td align="right">0.0407490</td>
<td align="right">0.0770173</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">R0</td>
<td align="left">60</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0605208</td>
<td align="right">0.0133160</td>
<td align="right">0.0391147</td>
<td align="right">0.0925138</td>
<td align="left">12</td>
</tr>
<tr class="odd">
<td align="left">19</td>
<td align="left">R0+MRI0</td>
<td align="left">12</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0301255</td>
<td align="right">0.0028766</td>
<td align="right">0.0249709</td>
<td align="right">0.0363046</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="left">R0+MRI0</td>
<td align="left">24</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0453218</td>
<td align="right">0.0047886</td>
<td align="right">0.0368092</td>
<td align="right">0.0556892</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="left">R0+MRI0</td>
<td align="left">36</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0528393</td>
<td align="right">0.0071275</td>
<td align="right">0.0404910</td>
<td align="right">0.0686838</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="left">R0+MRI0</td>
<td align="left">48</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0617580</td>
<td align="right">0.0123912</td>
<td align="right">0.0414903</td>
<td align="right">0.0909864</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">21</td>
<td align="left">R0+MRI0</td>
<td align="left">60</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0522835</td>
<td align="right">0.0160069</td>
<td align="right">0.0284559</td>
<td align="right">0.0941301</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">R1</td>
<td align="left">12</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.1555930</td>
<td align="right">0.0177865</td>
<td align="right">0.1238217</td>
<td align="right">0.1937142</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">R1</td>
<td align="left">24</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.0968276</td>
<td align="right">0.0238842</td>
<td align="right">0.0590630</td>
<td align="right">0.1547670</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">R1</td>
<td align="left">36</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>S</em><em>e</em><em>x</em> = <em>f</em><em>e</em><em>m</em><em>a</em><em>l</em><em>e</em></span><br>
</td>
<td align="right">0.0675213</td>
<td align="right">0.0301552</td>
<td align="right">0.0275421</td>
<td align="right">0.1562108</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="left">R2</td>
<td align="left">12</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.0318165</td>
<td align="right">0.0027740</td>
<td align="right">0.0268066</td>
<td align="right">0.0377264</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">18</td>
<td align="left">R2</td>
<td align="left">24</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.2069369</td>
<td align="right">0.0212869</td>
<td align="right">0.1683015</td>
<td align="right">0.2517566</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">R2</td>
<td align="left">36</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.1085905</td>
<td align="right">0.0268910</td>
<td align="right">0.0660072</td>
<td align="right">0.1735412</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">R2</td>
<td align="left">48</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.1211789</td>
<td align="right">0.0527918</td>
<td align="right">0.0495990</td>
<td align="right">0.2670357</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">R2</td>
<td align="left">60</td>
<td align="left">
<br><span class="math display"><em>E</em><em>D</em><em>S</em><em>S</em> = 2</span><br><br><span class="math display"><em>A</em><em>g</em><em>e</em> = 30</span><br>
</td>
<td align="right">0.1783812</td>
<td align="right">0.0991107</td>
<td align="right">0.0545388</td>
<td align="right">0.4496842</td>
<td align="left">2</td>
</tr>
</tbody>
</table>
<p>Adjusted Means.</p>
</div>
<div id="data" class="section level3">
<h3 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ADPIRA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="1%">
<col width="10%">
<col width="3%">
<col width="8%">
<col width="11%">
<col width="9%">
<col width="13%">
<col width="9%">
<col width="6%">
<col width="3%">
<col width="4%">
<col width="2%">
<col width="6%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">ARM</th>
<th align="left">ARMCD</th>
<th align="right">EDSS_start</th>
<th align="left">treatment_line</th>
<th align="left">prescription</th>
<th align="right">presc_months_cat</th>
<th align="right">EDSS_current</th>
<th align="right">dMRI_12m</th>
<th align="left">worse</th>
<th align="left">sex</th>
<th align="right">age</th>
<th align="right">AgeSympt</th>
<th align="right">Sympt2Presc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">0.5</td>
<td align="left">I</td>
<td align="left">INF</td>
<td align="right">12</td>
<td align="right">0.5</td>
<td align="right">3</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">24</td>
<td align="right">24</td>
<td align="right">200</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">3.0</td>
<td align="left">I</td>
<td align="left">INF</td>
<td align="right">12</td>
<td align="right">3.0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">54</td>
<td align="right">52</td>
<td align="right">986</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">0.0</td>
<td align="left">I</td>
<td align="left">GLA</td>
<td align="right">12</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">25</td>
<td align="right">24</td>
<td align="right">543</td>
</tr>
<tr class="even">
<td align="left">22</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">1.0</td>
<td align="left">I</td>
<td align="left">INF</td>
<td align="right">12</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">25</td>
<td align="right">23</td>
<td align="right">919</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">2.0</td>
<td align="left">I</td>
<td align="left">INF</td>
<td align="right">12</td>
<td align="right">1.5</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">37</td>
<td align="right">33</td>
<td align="right">1627</td>
</tr>
<tr class="even">
<td align="left">26</td>
<td align="left">R0: no relapse</td>
<td align="left">R0</td>
<td align="right">2.5</td>
<td align="left">I</td>
<td align="left">INF</td>
<td align="right">12</td>
<td align="right">2.0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">52</td>
<td align="right">43</td>
<td align="right">3124</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Kapica-Topczewska2021">
<p>Kapica-Topczewska, Katarzyna, François Collin, Joanna Tarasiuk, Agata Czarnowska, Monika Chorąży, Anna Mirończuk, Jan Kochanowicz, and Alina Kułakowska. 2021. “Assessment of Disability Progression Independent of Relapse and Brain Mri Activity in Patients with Multiple Sclerosis in Poland.” <em>Journal of Clinical Medicine</em> 10 (4). <a href="https://doi.org/10.3390/jcm10040868" class="uri">https://doi.org/10.3390/jcm10040868</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://creativecommons.org/licenses/by-nc-nd/4.0">CC BY-NC-ND 4.0</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>François Collin <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-0524-5755" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by François Collin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
